$\qquad$GPIO （General-Purpose Input/Output，通用型输入输出），是一种软件可编程的引脚，用户能够通过编程来控制这些引脚的输入或输出状态。
# GPIO端口的基本结构
![[GPIO端口基本结构.png]]
**外部**
- I/O引脚：用于与外界互动，输入或输出信息的接口
- 保护二极管：限定进入的电压在一定范围内（防止内部电路损坏。$V_{SS}=0\mathrm{V}，$$V_{DD}=3.3\mathrm{V}$，故电压被限制在0~3.3V之间。一部分STM32芯片的型号可以做到5V容忍，即可以接受0~5V的电压。

**输出驱动器**
- 两个MOS管：用于设置GPIO的[[STM32基本架构#推挽和开漏|推挽、开漏模式|]]
- 输出控制：用于控制两个MOS管的导通或关闭，实现输出信号

**输出读写控制**
- 位设置/清除寄存器：用于储存GPIO引脚到底输出高还是低电平，只能被写入
- 输出数据寄存器：用于存储实际GPIO引脚输出的电平状态，可以被读取和写入

**输入驱动器**
- 上/下拉电阻：用于将电压[[STM32基本架构#输入模式|上拉或下拉|]]
- TTL肖特基触发器：又称施密特触发器，用于稳定电平，能将模拟信号二值化

**输入读写控制**
- 输入数据寄存器：用于储存GPIO引脚输入后被二值化了的电平
- 模拟输入：直接输入从I/O口进来的信号，不经过二值化
# 输出模式
## 推挽和开漏
![[GPIO四种输出模式.png]]
## 通用和复用
- 通用（Universal）：指GPIO引脚被芯片直接控制

- 复用（Alternate Function）：指GPIO引脚被片上外设托管，单片机上的定时器，ADC等等都称作片上外设，这些外设可以通过操纵对应的GPIO引脚实现自己的功能

## 端口重映射
$\qquad$若同一端口被多个需要启动的外设占用，为了不使端口冲突，可以把其中一个外设的端口重映射到别的备用端口。
$\qquad$如打开F103的I2C1，就启动了默认端口PA6和PA7，这时再启用PA8或PA9的I2C1，原来的端口就关闭了，I2C1的功能转移到PA8和PA9上。

## GPIO输出电平切换
![[GPIO电平的切换.png]]
当切换频率快到一定程度时，半周期小于等于上升时间和下降时间，就会无法输出有效的高电平的现象，见图：
![[GPIO过快输出导致的异常.png]]
STM32提供了三种GPIO最大输出速度的模式（在Max Output Speed一栏）
![[GPIO口输出的三种速度模式.png]]
# 输入模式
![[GPIO三种输入模式.png]]
- 输入上拉（Input Pull-Up）：当引脚悬空时，默认输入高电平
- 输入下拉（Input Pull-Down）：当引脚悬空时，默认输入低电平
- 输入浮空（Input No Pull-Up and No Pull-Down）：当引脚悬空时，输入电平随机