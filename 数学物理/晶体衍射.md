#固体物理 #光学 
自Röntgen发现X射线以来，由于X光的波长太短，人们始终难以研究其干涉、衍射，直到Laue提出可以用晶体研究X光的衍射现象，人们才第一次确证X光的波动性质。
# Bragg定律
Bragg定律是一个相对简化的晶体衍射模型。
由于晶体中存在多种晶面族，可以认为入射的X光将被这些晶面作镜面反射。
由于X光具有强穿透性，可以认为每层晶面只反射入射光波的一小部分，当某晶面族各层晶面的反射波在某方向上是同位相时，便产生一个加强的反射束，该方向即为衍射线的方向。
![[布拉格反射.png]]
如图所示，一族晶面中相邻晶面反射波的波程差为$2d\sin \theta$，其中$d$为该晶面族的面间距，$\theta$为入射角或*Bragg角*。
当波程差是X光波长是$\lambda$的整数倍时，相邻晶面的反射线互相加强，由此得到衍射极大的条件：
$$2d\sin \theta=n\lambda$$
这就是*Bragg定律*。其中$n$是衍射级数。
Bragg定律成立的条件是$\lambda\leq2d$。
对于Miller指数为$(hkl)$的晶面族来说，有$$\lambda=\frac{2\pi}{|\vec{k}|},\quad d_{hkl}=\frac{2\pi}{|\vec{G}_{hkl}|}$$
因此Bragg定律总共有两种形式：
- **Bragg定律的几何形式**：$$2d\sin \theta=n\lambda$$
- **Bragg定律的波矢形式**：$$|\vec{k}|=|\vec{k}+\vec{G}_{hkl}|$$
# X光衍射波
## 散射的振幅
X光在晶体中的衍射主要与电子相互作用，依据[[光的衍射#Huygens-Fersnel原理]]，电子受迫振动成为次级波源发出波，这些波发生干涉就产生了衍射现象。
从[[光的衍射#Kirchhoff衍射公式]]出发，
$\tilde{E}(Q)$是电子发出的次级波的复振幅，设电子所处的位置是$\vec{r}$，在$\vec{r}$附近的体积元$\mathrm{d}V$中电子的数量是$\rho(\vec{r})\mathrm{d}V$，一个很自然的假设是$$\tilde{E}(Q)\propto \rho(\vec{r})\mathrm{d}V$$
然后又因为$\tilde{E}(Q)$是由入射进来的X光平面波导致的，所以也必须和$\tilde{E}(\vec{r})=E_{0}e^{i\vec{k}_{i}\cdot \vec{r}}$成正比。
我们最终要推导的式子是会把常数项归一的，因此不妨直接令$$\tilde{E}(Q)={\tilde{E}(\vec{r})}\rho(\vec{r})\mathrm{d}V$$
$\vec{r}$处的电子受迫振动产生的波要传到$P$点（$\vec{R}$处），所以$$\mathrm{d}\tilde{E}(\vec{R})=CK(\theta) \underbrace{\frac{e^{ik(\vec{R}-\vec{r})}}{|\vec{R}-\vec{r}|}}_{\vec{r}到P的球面波}\underbrace{\tilde{E}(\vec{r})}_{照射来的X平面波}\rho(\vec{r})\mathrm{d}V$$
和Kirchhoff衍射公式不同，我们需要对整个晶体的体积积分$$\tilde{E}(\vec{R})=\iiint_{全晶体} CK(\theta)\frac{e^{ik|\vec{R}-\vec{r}|}}{|\vec{R}-\vec{r}|}\tilde{E}(\vec{r})\rho(\vec{r})\mathrm{d}V$$
在这里我们采纳[[光的衍射#Fraunhofer衍射]]的假设（远场衍射，即$R \gg r$），在这个假设下
$$\text{对相位：}|\vec{R}-\vec{r}|\approx R-\vec{r}\cdot  \hat{R},\quad \text{对分母：}|\vec{R}-\vec{r}|\approx R,\quad \text{对角向：}K(\theta)\approx \mathrm{Const}$$
先计算指数
$$\frac{e^{ik(R-\vec{r}\cdot \hat{R})}}{R}\cdot \tilde{E}(\vec{r})=\frac{e^{ik(R-\vec{r}\cdot \hat{R})}}{R}\cdot E_{0}e^{i\vec{k}_{i}\cdot \vec{r}}=\frac{1}{R}e^{i(kR-k \vec{r}\cdot \hat{R}+\vec{k}_{i}\cdot \vec{r})}=\frac{1}{R}e^{ikR+i(\vec{k}_{i}-\vec{k}_{s})\cdot \vec{r}}$$
其中设$\vec{k}_{s}=k \hat{R}$，然后称$\vec{s}=\vec{k}_{s}-\vec{k}_{i}$（末减初）为*散射矢量*（或*动量转移矢量*）
于是
$$
\begin{align}
\tilde{E}(\vec{R})&\propto \iiint C' \frac{1}{R}e^{ikR}\cdot e^{-i \vec{s}\cdot \vec{r}}\rho(\vec{r})\mathrm{d}^3\vec{r} \\
&\propto \iiint \rho(\vec{r})e^{-i\vec{s}\cdot \vec{r}}\mathrm{d}^3\vec{r} \\
&\propto \mathcal{F}[\rho(\vec{r})]
\end{align}
$$
在$\vec{R}$固定的时候，$\tilde{E}(\vec{R})$就只和$\vec{s}$有关了，所以不妨改写为$\tilde{E}(\vec{s})$。
至此我们发现，*散射的复振幅和电子密度分布的Fourier变换成正比*。
## 原子散射因子和几何结构因子
不过上面的讨论都处于一个连续的电子云的图景，实际上晶体中的电子密度并不是连续的，即便在考虑量子效应的情况下，电子在少数几个位置出现的概率也是显著高于其他位置。
所以针对描述整体电子分布$\rho(\vec{r})$，我们可以把它分解为晶体中各个原子中的电子所贡献的电子分布$$\rho(\vec{r})=\sum_{j}\rho_{j}(\vec{r}-\vec{r}_{j})$$
为什么以原子为单位离散化而不是以电子为单位离散化？因为晶体中的点阵周期性就是以原子为单位的，以原子为单元的话，就可以使用格矢这个强大的工具，直接代入了。
代入
$$
\begin{align}
\tilde{E}(\vec{R})
&\propto \iiint \sum_{j}\rho_{j}(\vec{r}-\vec{r}_{j}) e^{-i\vec{s}\cdot \vec{r}}\mathrm{d}^3\vec{r} \\ \\
&=\sum_{j}\iiint e^{-i \vec{s}\cdot \vec{r}_{j}}\rho(\vec{r}-\vec{r}_{j})e^{-i\vec{s}\cdot(\vec{r}-\vec{r}_{j})}\mathrm{d}^3(\vec{r}-\vec{r}_{j}) \\
\end{align}
$$
我们设
$$f_{j}(\vec{s})=\iiint \rho(\vec{r}-\vec{r}_{j})e^{-i\vec{s}\cdot(\vec{r}-\vec{r}_{j})}\mathrm{d}^3(\vec{r}-\vec{r}_{j}) $$
$f_{j}(\vec{s})$被称作*原子散射因子*
于是
$$\tilde{E}(\vec{s})\propto\sum_{j}f_{j}(\vec{s})e^{-i\vec{s}\cdot \vec{r}_{j}}$$
又设
$$F(\vec{s})=\sum_{j}f_{j}(\vec{s})e^{-i\vec{s}\cdot \vec{r}_{j}}$$
称$F(\vec{s})$为*几何结构因子*。
- *原子散射因子*的意义是：$$f_{j}(\vec{s})=\iiint \rho(\vec{r})e^{-i\vec{s}\cdot(\vec{r})}\mathrm{d}^3\vec{r} = \frac{\text{原子散射中心处一个电子的散射波振幅}}{\text{原子内所有电子散射波振幅的几何和}}$$它描述的是单个原子的情况，它把原子中众多的电子打包成一个因素。
- *几何结构因子*的意义是：$$F(\vec{s})=\sum_{j}f_{j}(\vec{s})e^{-i\vec{s}\cdot \vec{r}_{j}}= \frac{\text{原胞散射中心处一个电子散射波振幅}}{\text{原胞内所有原子散射波振幅的几何和}}$$它描述的是单个原胞的情况，实际上就已经是整个晶体的情况了。
## Laue条件
由$$\tilde{E}(\vec{s})\propto\sum_{j}f_{j}(\vec{s})e^{-i\vec{s}\cdot \vec{r}_{j}}$$可看出，散射出的光波其波数就是$\vec{s}$。
如果$\vec{r}=0$处发射的散射光，要和$\vec{r}=\vec{R}$（正格矢），处发射的散射光发生干涉，那就需要相位差$$\varphi=\vec{s}\cdot \vec{R}=2\pi m,\quad m=0,\pm 1,\pm 2,\dots$$
显然，满足这样条件的$\vec{s}$就是[[正格子与倒格子]]中的倒格矢，即$$\vec{s}=\vec{G}= m_{1}\vec{b}_{1}+m_{2}\vec{b}_{2}+m_{3}\vec{b}_{3}$$
这被称作*Laue条件*。
若设$$\vec{s}=\vec{k}_{s}-\vec{k}_{i}=\frac{2\pi}{\lambda}(\hat{s}-\hat{i})$$其中$\hat{i}$是入射方向的单位矢量，$\hat{s}$是散射方向矢量。
和格矢点积之后的方程$$\begin{equation}
\left\{
\begin{aligned}
&n_{1}(\hat{s}-\hat{i})=m_{1}\lambda\\
&n_{2}(\hat{s}-\hat{i})=m_{2}\lambda\\
&n_{3}(\hat{s}-\hat{i})=m_{3}\lambda
\end{aligned}
\right.
\end{equation}$$
这被称作*Laue方程*。
## 晶体衍射问题的Fourier变换对
上述问题中，电子密度分布函数$\rho(\vec{r})$和几何结构因子$\vec{F}(\vec{s})$构成Fourier变换对
$$\begin{equation}
\left\{
\begin{aligned}
&F(\vec{s})=\iiint \rho(\vec{r})e^{-i \vec{s}\cdot \vec{r}}\mathrm{d}^3 \vec{r}\\
&\rho(\vec{r})=\frac{1}{V}\iiint F(\vec{s})e^{i\vec{s}\cdot \vec{r}}\mathrm{d}^3\vec{s}
\end{aligned}
\right.
\end{equation}$$
如果运用Laue条件，倒格子空间中只有在$\vec{s}=\vec{G}$的地方不为0，第二项将从积分变为求和$$\begin{equation}
\left\{
\begin{aligned}
&F(\vec{s})=\iiint \rho(\vec{r})e^{-2\pi i(m_{1}x+m_{2}y+m_{3}z)}\mathrm{d}x\mathrm{d}y\mathrm{d}z\\
&\rho(\vec{r})=\frac{1}{V}\sum_{m_{1},m_{2},m_{3}} F(m_{1},m_{2},m_{3})e^{2\pi i(m_{1}x+m_{2}y+m_{3}z)}
\end{aligned}
\right.
\end{equation}$$
# Ewaid反射球
Laue条件$\vec{s}=\vec{k}_{s}-\vec{k}_{i}=\vec{G}$可以很方便的用图像表示。
对于弹性散射来说，散射前后波矢的方向虽然变了，但$|\vec{k}_{i}|=|\vec{k}_{s}|=2\pi/\lambda$始终不变。这个时候，$\vec{k}_{i},\vec{k}_{s},\vec{G}$总是构成等腰三角形。所以可以通过作图的方式，来确定衍射的方向。
![[厄瓦尔德球.png]]
如图所示，右边的点列是晶体的倒格子点。（图中的$\vec{k}_{0}$是$\vec{k}_{i}$，$\vec{k}$是$\vec{k}_{s}$，$\vec{G}_{h}$是$\vec{G}$）
以$\vec{k}_{i}$为圆心，作一个半径为$2\pi/\lambda$的球，如果有倒格子点落在球上，就会形成一个衍射束。
图中所画的球上就落有一个倒格子点，这个点与$\vec{k}_{i}$的终点由倒格矢连接，则衍射X射线束的方向是$\vec{k}_{s}=\vec{k}_{i}+\vec{G}$，$\theta$就是Bragg角。
该衍射球称为Ewaid反射球。